var knx = require("knx");

var myknxhealthconnection = knx.Connection({
	//ipAddr: "192.168.0.30",
	//ipPort: "3671",
	//debug: true,
	//interface: 'eth0',
	//useMulticastTunneling: true,
	//physAddr: process.env.KNX_SOURCEADDRESS,
	handlers: {
		connected: function() {
			function checkdp() {
				var dp = new knx.Datapoint({
					ga: "0/1/50",
					dpt: "DPT1"
				}, myknxhealthconnection);
				dp.read((src, value) => {
					console.log("**** HEALTHCHECK - GA %j reports current value: %j", "0/1/50", value);
					process.exit(0);
				});
				console.log("ERROR : connection to KNX bus and/or healthcheck group address timed out");
				process.exit(1);
			}
			setTimeout(checkdp, 2000);
		}
	}
});
