var knx = require("knx");
// var mainfct = require('./../index.js');

// mainfct.checkdpfct("0/1/6");


//var options = {  
//    host : "localhost",
//    port : "2368",
//    timeout : 2000
//};

//var request = http.request(options, (res) => {  
//    console.log(`STATUS: ${res.statusCode}`);
//    if (res.statusCode == 200) {
//        process.exit(0);
//    }
//    else {
//        process.exit(1);
//    }
//});

//request.on('error', function(err) {  
//    console.log('ERROR');
//    process.exit(1);
//});

//request.end();  

var myknxhealthconnection = knx.Connection({
	//ipAddr: "192.168.0.30",
	//ipPort: "3671",
	//debug: true,
	//interface: 'eth0',
	//useMulticastTunneling: true,
	//physAddr: process.env.KNX_SOURCEADDRESS,
	handlers: {
		connected: function() {
			function checkdp() {
				var dp = new knx.Datapoint({
					ga: "0/1/50",
					dpt: "DPT1"
				}, myknxhealthconnection);
				dp.read((src, value) => {
					console.log("**** HEALTHCHECK - GA %j reports current value: %j", "0/1/50", value);
				});
				alert("ERROR : connection to KNX bus and/or healthcheck group address timed out");
			}
			setTimeout(checkdp, 2000);
		}
	}
});
